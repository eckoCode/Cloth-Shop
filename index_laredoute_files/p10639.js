
(function(d, w) {
  if (!d.createElement) { return false; }
  var partnerInfo = {};
  var loadPartnerTag = function() {
    var self = {};
    self.tagsZone = {"accueil":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=14615&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_home.js\";adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"OnAudience","object":"img","attr":{"src":"\/\/pixel.onaudience.com\/?event=3352115","width":"0","height":"0"}},{"nom":"VizuryNEW","object":"script","attr":{"id":"id1","type":"text\/javascript","src":"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595"}}],"produit":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=14616&pid={IDPRODUIT}&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_tag_104397_brand=\"{IDCATEGORIE}\",adv_cst_v_tag_104397_product=\"{IDPRODUIT}\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_tag.js\";adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"VizuryNEW","object":"script","attr":{"type":"text\/javascript","text":"(function(b,c){b.vizLayer={type:\"product_page\",pid:\"{IDPRODUIT}\",lp:b.location,catid:\"{IDCATEGORIE}\"};var a=c.createElement(\"script\");a.type=\"text\/javascript\";a.src=\"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595\";c.getElementsByTagName(\"script\")[0].parentNode.appendChild(a)})(window,document);"}}],"categorie":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=41262&pid={LISTEIDS}&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_listing_104397_listing_type=\"{IDCATEGORIE}\",adv_cst_v_listing_104397_product=\"{LISTEIDS}\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_listing.js\";adv_header.appendChild(adv_rt_script)}catch(e$$4){};"}},{"nom":"VizuryNEW","object":"script","attr":{"id":"id1","type":"text\/javascript","src":"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595"}}],"panier":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=14617&pid={LISTEIDS}&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_cart_104397_product=\"{IDPRODUIT}\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_cart.js\";adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"OnAudience","object":"img","attr":{"src":"\/\/pixel.onaudience.com\/?event=3352116","width":"0","height":"0"}},{"nom":"VizuryNEW","object":"script","attr":{"type":"text\/javascript","text":"(function(a,d){a.vizLayer={type:\"shopping_cart\",cartval:encodeURIComponent(\"{MONTANT}\")};if(\"undefined\"!=typeof a.ptag_params&&\"undefined\"!=typeof a.ptag_params.products)for(i=0;i<a.ptag_params.products.length;i++)a.vizLayer[\"pid\"+(i+1)]=encodeURIComponent(a.ptag_params.products[i].id);else for(b=\"{LISTEIDS}\",e=b.split(\",\"),i=e.length-1;0<=i;i--)a.vizLayer[\"pid\"+(i+1)]=encodeURIComponent(e[i]);var c=d.createElement(\"script\");c.type=\"text\/javascript\";c.src=\"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595\";d.getElementsByTagName(\"script\")[0].parentNode.appendChild(c)})(window,document);"}}],"fincommande":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=14618&id={IDTRANSACTION}&mt={MONTANT}&pid={LISTEIDS}&tvalid=1&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_confirmation_104397_orderid=\"{IDTRANSACTION}\",adv_cst_v_confirmation_104397_product=\"{LISTEIDS}\",adv_cst_v_confirmation_104397_section=\"{IDTRANSACTION},{MONTANT}\",adv_cst_v_confirmation_104397_totalorder=\"{MONTANT}\",adv_script=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_confirmation.js\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=adv_script;adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"OnAudience","object":"img","attr":{"src":"\/\/pixel.onaudience.com\/?event=3352117","width":"0","height":"0"}},{"nom":"VizuryNEW","object":"script","attr":{"type":"text\/javascript","text":"(function(c,d){if(\"undefined\"!=typeof c.ptag_params&&\"undefined\"!=typeof c.ptag_params.products)for(var b=\"\",a=0;a<c.ptag_params.products.length;a++)b+=\"&pid\"+(a+1)+\"=\"+encodeURIComponent(c.ptag_params.products[a].id)+\"&price\"+(a+1)+\"=\"+encodeURIComponent(c.ptag_params.products[a].price);else for(var b=\"\",e=[\"{LISTEIDS}\"],a=e.length-1;0<=a;a--)b+=\"&pid\"+(a+1)+\"=\"+encodeURIComponent(e[a])+\"&price\"+(a+1)+\"=\";a=d.createElement(\"iframe\");a.src=\"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595&param=e500&orderid={IDTRANSACTION}&orderprice={MONTANT}&isvizconv=&section=1&level=1\"+b;a.scrolling=\"no\";a.width=1;a.height=1;a.marginheight=0;a.marginwidth=0;a.frameborder=0;b=d.getElementsByTagName(\"script\")[0];b.parentNode.insertBefore(a,b)})(window,document);"}}],"lead_confirmation":[{"nom":"NextPerformance","object":"script","attr":{"type":"text\/javascript","src":"\/\/nxtck.com\/act.php?tag=&id={ID_LEAD}&tvalid=1&m_md5={MD5EMAIL}"}},{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_confirmation_104397_product=\"\",adv_cst_v_confirmation_104397_section=\"\",adv_script=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_confirmation.js\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=adv_script;adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"VizuryNEW","object":"script","attr":{"id":"id1","type":"text\/javascript","src":"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595"}}],"lead_inscription":[{"nom":"Adverline","object":"script","attr":{"type":"text\/javascript","text":"var adv_cst_v_tag_104397_brand=\"\",adv_cst_v_tag_104397_product=\"\";try{var adv_header=document.getElementsByTagName(\"head\")[0],adv_rt_script=document.createElement(\"script\");adv_rt_script.type=\"text\/javascript\";adv_rt_script.src=\"\/\/ads2.adverline.com\/retargetproduit\/partnertag\/104397_tag.js\";adv_header.appendChild(adv_rt_script)}catch(e$$12){};"}},{"nom":"VizuryNEW","object":"script","attr":{"id":"id1","type":"text\/javascript","src":"\/\/cdn6.vizury.com\/analyze\/pixel.php?account_id=VIZVRM5595"}}]};
    if (typeof netaffWanTtWcCdth59575 == 'undefined') {
      netaffWanTtWcCdth59575 = new Object();
      var netaffTabPattern = checkParams(NetaffParseParam(partnerInfo.str_js));
      NetaffCD(netaffTabPattern);
      var zone = eval('self.tagsZone.'+netaffTabPattern['ZONE']);
      if(typeof(zone) == 'object') {
        for(var i_cpt_tag = 0; i_cpt_tag < zone.length; ++i_cpt_tag) {
          if(typeof zone[i_cpt_tag] != 'undefined'){
            if(zone[i_cpt_tag].object == 'script' || zone[i_cpt_tag].object == 'img' || zone[i_cpt_tag].object == 'iframe'){
              partnerInfo.divConteneur.innerHTML += "\n\n<!-- Tag "+zone[i_cpt_tag].nom+" -->\n";
              var tag = d.createElement(zone[i_cpt_tag].object);
              var tab_attr = zone[i_cpt_tag].attr;
              var script_src = false;
              for (var type_attr in tab_attr) {
                if (tab_attr.hasOwnProperty(type_attr)){
                  var code = tab_attr[type_attr];
                  if(type_attr == 'src' || type_attr == 'text'){
                    if(type_attr == 'src'){ script_src = true; }
                    if(d.location.protocol == 'https:'){ code = code.replace(new RegExp('(^http://)|(("|\')http://)', 'g'), '$3https://'); }
                    var nomFonctionFiltre = null;
                    var nom_fct_filtre = NetaffRemplaceChar('filtre_'+zone[i_cpt_tag].nom.toLowerCase()+'_'+netaffTabPattern['ZONE'], '-', '_');
                    if(eval('typeof '+nom_fct_filtre+' == "function"')){ nomFonctionFiltre = nom_fct_filtre; }
                    code = NetaffPattern(code, netaffTabPattern, nomFonctionFiltre);
                  }
                  eval('tag.'+type_attr+'=code')
                }
              }
              if(zone[i_cpt_tag].object == 'script' && script_src){ d.getElementsByTagName('head')[0].appendChild(tag); }
              else if(zone[i_cpt_tag].nom.toLowerCase() != "criteo_onetag" || (zone[i_cpt_tag].nom.toLowerCase() == "criteo_onetag" && typeof w.ptag_params != 'undefined')){ partnerInfo.divConteneur.appendChild(tag); }
              tag = tab_attr = type_attr = code = null;
            }
          }
        }
        netaffTabPattern = null;
      }
      zone = null;
    }
  };

  partnerInfo.divConteneur = creerDivPartnerTag();

  if (typeof w.ptag_params != 'undefined' && w.ptag_params.hasOwnProperty('requiresDOM') && w.ptag_params.requiresDOM === false) { loadPartnerTag(); }
  else if (w.addEventListener) {
    w.addEventListener('load', loadPartnerTag, false);
    var timeoutID = window.setTimeout(function(){Timer();},1000);
  }
  else if (w.attachEvent) {
    w.attachEvent('onload', loadPartnerTag );
    var timeoutID = window.setTimeout(function(){Timer();},1000);
  }

  var listeClicTime = [];
  if (listeClicTime.length > 0) {
    poseClicTime(listeClicTime);
  }
  function poseClicTime(listeClicTime) {
    var tagClicTime = d.createElement('script');
    for(var i in listeClicTime) {
      tagClicTime.innerHTML += listeClicTime[i];
    }
    partnerInfo.divConteneur.appendChild(tagClicTime);
  }
  function creerDivPartnerTag() {
    var self = {};
    self.tabUrl = ["img.metaffiliation.com/u/2/p59575.js","img.netaffiliation.com/u/2/p59575.js","img.metaffiliation.com/u/20/p10639.js","img.netaffiliation.com/u/20/p10639.js"];
    partnerInfo.str_js = null;
    var allScripts = d.getElementsByTagName('script');
    for (var i = 0; i < self.tabUrl.length; i++) {
      if (partnerInfo.str_js != null){break;}
      for (var i_cpt_allscr = 0 ; i_cpt_allscr < allScripts.length ; i_cpt_allscr++) {
        var currentScript = allScripts.item(i_cpt_allscr);
        if(!currentScript.src){continue; }
        var reg_src_js = new RegExp(self.tabUrl[i],'g');
        if (reg_src_js.test(currentScript.src)) {
          var index = currentScript.src.indexOf('?',7);
          if (index == -1){ partnerInfo.str_js = ''; break; }
          partnerInfo.str_js = currentScript.src.substring(index+1);
        }
        if (partnerInfo.str_js != null){ break; }
      }
      var divConteneur = d.createElement('div');
      divConteneur.id = 'Netaff-'+NetaffAleat(15);
      divConteneur.style.display = 'none';
      var currentScriptParent = currentScript.parentNode;
      currentScriptParent.appendChild(divConteneur);
    }
    return divConteneur;
  }
  function Timer() {
    if(document.readyState == 'complete' && typeof netaffWanTtWcCdth59575 !== 'object'){ loadPartnerTag(); }
    else if(typeof netaffWanTtWcCdth59575 === 'object'){ window.clearTimeout(timeoutID); }
    else{ timeoutID = window.setTimeout(function(){Timer();},1000); }
  }
  function callBackProgramme() {

  }
  function checkParams(params_url){
    var netaffTabParams = new Array();
    netaffTabParams['IDPROGNETAFF'] = '59575';
    var varFr = ['idproduit','idcategorie','idtransaction','accueil','produit','categorie','panier','fincommande'];
    var varEn = ['productid','categoryid','transactionid','homepage','product','listing','basket','transaction'];
    callBackProgramme();
    var boucle = [params_url, w.ptag_params];
    for (var index = 0; index < boucle.length; ++index) {
      for (var nom_param in boucle[index]) {
        var keyPattern = nom_param.toUpperCase();
        for(var i = 0; i < varEn.length; i++) {
          if(varEn[i] == nom_param.toLowerCase()){ keyPattern = varFr[i].toUpperCase(); }
        }
        netaffTabParams[keyPattern] = boucle[index][nom_param];
      }
    }
    for(var i = 0; i < varEn.length; i++) {
      if(varEn[i] == netaffTabParams['ZONE']){ netaffTabParams['ZONE'] = varFr[i]; }
    }
    // On rempli le tableau
    switch(netaffTabParams['ZONE']) {
      case "panier":
      case "fincommande":
        if(typeof netaffTabParams['PRODUCTS'] == 'object'){
          var montantTot = 0;
          for (var ind = 0; ind < netaffTabParams['PRODUCTS'].length; ++ind) {
            netaffTabParams['LISTEIDS'] = (netaffTabParams['LISTEIDS'] ? netaffTabParams['LISTEIDS']+',' : '')+netaffTabParams['PRODUCTS'][ind]['id'];
            netaffTabParams['LISTEQTY'] = (netaffTabParams['LISTEQTY'] ? netaffTabParams['LISTEQTY']+',' : '')+netaffTabParams['PRODUCTS'][ind]['quantity'];
            montantTot = montantTot+parseFloat(parseFloat(netaffTabParams['PRODUCTS'][ind]['price'])*parseInt(netaffTabParams['PRODUCTS'][ind]['quantity']));
          }
          netaffTabParams['MONTANT'] = montantTot;
        }
      break;
      case "categorie":
        if(typeof netaffTabParams['PRODUCTS'] == 'object'){
          for (var ind = 0; ind < netaffTabParams['PRODUCTS'].length; ++ind) {
            netaffTabParams['LISTEIDS'] = (netaffTabParams['LISTEIDS'] ? netaffTabParams['LISTEIDS']+',' : '')+netaffTabParams['PRODUCTS'][ind];
          }
        }
      break;
    }
    if(netaffTabParams['LISTEIDS']){ netaffTabParams['LISTEIDS'] = NetaffRemplaceChar(netaffTabParams['LISTEIDS'],'%2C',','); }
    if(netaffTabParams['LISTEQTY']){ netaffTabParams['LISTEQTY'] = NetaffRemplaceChar(netaffTabParams['LISTEQTY'],'%2C',','); }
    return netaffTabParams;
  }
  function NetaffParseParam(url) {
    var result = new Array();
    if(url == null || url == ''){ return result; }
    var params = url.split('&');
    for(var i_cpt_parse = 0; i_cpt_parse < params.length; ++i_cpt_parse) {
      var t = params[i_cpt_parse].split('=');
      if(t[1] == 'generique'){ t[1] = 'accueil'; }
      if(t[0].substring(0, 4) == 'amp;'){ t[0] = t[0].substring(4, t[0].length); }
      result[t[0]] = t[1];
    }
    return result;
  }
  function NetaffPattern(str, netaffTabPatternARemplacer, nomFonction) {
    netaffTabPatternARemplacer['cachebuster'] = NetaffAleat(15);
    for (var pattern in netaffTabPatternARemplacer) {
      var valuePat = netaffTabPatternARemplacer[pattern];
      if(nomFonction != null){ eval('valuePat = '+nomFonction+'(valuePat, pattern)'); }
      var reg_pattern = new RegExp('{'+pattern+'}', 'g');
      str = str.replace(reg_pattern, valuePat);
    }
    return str;
  }
  function NetaffAleat(length) {
    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
    if (!length) { length = Math.floor(Math.random() * chars.length);  }
    var str = '';
    for (var i_cpt_aleat = 0; i_cpt_aleat < length; i_cpt_aleat++) {
      str += chars[Math.floor(Math.random() * chars.length)];
    }
    return str;
  }
  function NetaffRemplaceChar(chaine, caractere_in, caractere_out) {
    var strrc = '';
    var tabrc = chaine.split(caractere_in);
    for (var irc=0; irc<tabrc.length; irc++){
      if(tabrc[irc] != ''){
        (strrc != '') ? strrc = strrc+caractere_out+tabrc[irc] : strrc = tabrc[irc];
      }
    }
    tabrc = irc = null;
    return strrc;
  }
  function NetaffCD(netaffTabPattern) {
    if(netaffTabPattern.hasOwnProperty('M_MD5') && netaffTabPattern['M_MD5'] != ''){
      url_cd = '//action.metaffiliation.com/aff.php?maff=S4E8B71010';
      var imgCD = document.createElement('img');
      imgCD.setAttribute('src', url_cd+'&r='+new Date().getTime()+'&altid='+netaffTabPattern['M_MD5']);
      imgCD.setAttribute('width', '0');
      imgCD.setAttribute('height', '0');
      imgCD.setAttribute('id', "kwankoCD");
      partnerInfo.divConteneur.appendChild(imgCD);
    }
  }
  
})(document, window);